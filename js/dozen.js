!function(e,n,t,o,i,r){"use strict";function c(){}function s(e){return n.getElementById(e)}function u(e){return n.querySelectorAll(e)}function a(e){return n.querySelector(e)}function l(e,n){e.classList.add(n)}function f(e,n){e.classList.remove(n)}function d(e,n){return e.classList.contains(n)}function h(e,n){e.textContent=n}function p(e){l(e,"hide")}function m(e){s(e).style.display="block"}function g(e){s(e).style.display="none"}function v(){function n(e,n){var t={};return t.slidesPerView=e,t.breakpoints={},n.forEach(function(e){t.breakpoints[e[0]]={slidesPerView:e[1]}}),t}var t=s("carousel-modes");if(d(t,"initialized"))d(t,"resize")&&(s("carousel-modes").swiper.update(),s("carousel-controls").swiper.update(),s("carousel-speeds").swiper.update(),f(t,"resize"));else{l(t,"initialized"),e.MutationObserver||e.on("resize",debounce(function(){l(t,"resize")}));var i={grabCursor:!0,roundLengths:!0,watchOverflow:!0,longSwipesRatio:.25,resistanceRatio:.8,slideToClickedSlide:!0,observer:!0,observeParents:!0,setWrapperSize:!0,runCallbacksOnInit:!1,pagination:{el:".swiper-pagination",clickable:!0},mousewheel:{releaseOnEdges:!0}};new Swiper("#carousel-modes",o.extend(i,n(3,[[500,1],[820,2]]))),new Swiper("#carousel-controls",o.extend(i,n(3,[[550,1],[800,2]]))),new Swiper("#carousel-speeds",o.extend(i,n(4,[[600,1],[1280,2],[1920,3]])))}}function T(e,n){return"c-"+e+"-"+n}function w(e){var n=e.getBoundingClientRect(),t=e.offsetParent.getBoundingClientRect();return{top:n.top-t.top,left:n.left-t.left}}function y(e){return e.getBoundingClientRect().width}function S(e){return e.getBoundingClientRect().height}function O(e,n){var t=an.get(e,n);return t||(t=w(s(T(e,n))),an.set(e,n,t),t)}function b(e){return Math.round(Math.log2(e))}function E(e){return e>0&&e%12==0}function z(e){for(var n=0,t=e.length;n<t;++n)if(e[n]!==e[0])return!1;return!0}function A(e){return e.every(E)&&z(e)}function N(e,n,t){e.style[sn]=ln(O(n,t))}function M(e){return e>=4&&on.isPowerOf2(e)?4:e>=12?12*Math.pow(2,b(e/12)%3):e}function C(e,n){l(e,"t"+M(n)),n>=100&&l(e,"large"),h(e,n)}function I(e,n,t){if(t){if(n===t)return;e.children().filter(".t"+n).removeClass("d").end().filter(".t"+t).addClass("d")}else e.children().addClass("d").filter(".t"+n).removeClass("d")}function P(e,n,t){return new r(t).set(e,{css:{x:n.left,y:n.top,scale:1,rotation:0}}).to(e,.25*pn,{css:{scale:.82},ease:Power1.easeInOut}).to(e,.5*pn,{css:{scale:1.16},ease:Power1.easeInOut}).to(e,.25*pn,{css:{scale:1},ease:Power1.easeInOut})}function R(e,n){return(new r).set(e,{css:{x:n.left,y:n.top,scale:1,rotation:0}}).to(e,.25*hn,{css:{scale:1.22,rotation:0}}).to(e,.75*hn,{css:{scale:0,rotation:720}})}function x(e,n,t){var o=1e3/60/1e3;return new TimelineMax({repeat:n/1e3/(5*o)-1,onComplete:t}).fromTo(e,o,{css:{transform:"translate(-0.1em, -0.1em)"}},{css:{transform:"translate(0, -0.2em)"},ease:Power1.easeInOut}).to(e,o,{css:{transform:"translate(0.2em, 0)"},ease:Power1.easeInOut}).to(e,o,{css:{transform:"translate(0, 0.2em)"},ease:Power1.easeInOut}).to(e,o,{css:{transform:"translate(-0.2em, 0)"},ease:Power1.easeInOut}).to(e,o,{css:{transform:"translate(-0.1em, -0.1em)",clearProps:"all"},ease:Power1.easeInOut})}function k(e,n,t){return TweenMax.fromTo(e,1e3/60/1e3*2,{css:{transform:"translateX(-0.125em)"}},{css:{transform:"translateX(0.125em)",clearProps:"all",force3D:"auto"},ease:Linear.easeNone,repeat:n/1e3/(1e3/60/1e3*2)-1,yoyo:!0,onComplete:t})}function L(e,n,t){return TweenMax.fromTo(e,1e3/60/1e3*2,{css:{rotation:1.5}},{css:{rotation:-1.5,clearProps:"all",force3D:"auto"},ease:Linear.easeNone,repeat:n/1e3/(1e3/60/1e3*2)-1,yoyo:!0,onComplete:t})}function D(e,n,t,o,i){e.add(P(n,O(t,o)),i)}function _(e){switch(e){case $e.FILTHY:return gn.FILTHY;case $e.DIRTY:return gn.DIRTY;default:case $e.CLEAN:return gn.CLEAN}}function G(e){An.row=Pn,An.col=Rn,e&&(An.level=En.level,An.lines=En.lines.curr,An.score=En.score.curr,An.tile=xn,An.next=kn,rn.copy2d(In,An.grid),rn.copy(Mn.state.bag,An.rng.bag),An.rng.i=Mn.state.i)}function j(){(An={level:0,lines:0,score:0,tile:1,next:1,row:0,col:0,grid:[],rng:{}}).grid=rn.make2d(An.grid,zn.size.rows,zn.size.cols,0),o.extend(!0,An.rng,Mn.state),G(!0)}function H(){j(),Nn=o.extend(!0,{},An)}function Y(){var e=Nn;Nn=An,An=e,G(!0)}function V(){}function F(e,n){e.filter(".selected").removeClass("selected"),e.filter('[data-option="'+n+'"]').addClass("selected")}function W(e,n){e in Dn||(Dn[e]=n,tn.saveSettings(Dn))}function J(e,n){return 0===In[e][n]}function U(){l(this,"d")}function X(e){i.set(e,{css:{y:0,opacity:1}}),i.to(e,1.5,{css:{transform:"translateY(-1.5em)",opacity:0},ease:Power1.easeInOut,onComplete:U,onCompleteScope:e})}function B(e,n){var t=s(e);return h(t,n),f(t,"d"),t}function K(e){var n;En.lines.curr+=e,h(s("lines"),En.lines.curr),X(B("line-mod","+"+e)),En.lines.best<En.lines.curr&&(En.lines.best=En.lines.curr,En.lines.isNew&&(En.lines.isNew=!1)),En.lines.curr>=(En.level+1)*vn&&(n=Math.floor(En.lines.curr/vn),h(s("level"),n),X(B("level-mod","+"+(n-En.level))),En.level=n)}function q(e,n,t){switch(e){default:case en.CLASSIC:return n-En.level*t;case en.FAST:return n-9*t;case en.SLOW:return n-3*t;case en.PRACTICE:return mn}}function Z(){var e=zn.size.rows-1,n=6*mn/e,t=Math.round(333/e);return Math.max(q(zn.speed,n,(n-t)/13),t)}function Q(e,n){switch(zn.mode){case $e.CLEAN:return e+n===3||e===n&&e>=3;case $e.DIRTY:return e+n===3||e===n&&2!==e;case $e.FILTHY:return e+n===3||e===n;default:throw new Error("Invalid mode!")}}function $(){var e=In.length-1,n=Math.floor(In[0].length/2),t=In[e][n];return 0===t||Q(t,kn)}function ee(){return En.score.curr>=Gn}function ne(){N(Cn,Pn,Rn)}function te(){Yn=!1,Hn=setTimeout(Re,Z()),Ln()}function oe(){clearTimeout(Hn)}function ie(){if(!$()||ee())return Yn=!1,V(),void Zn.goTo(Zn.Ending);Pn=In.length-1,Rn=Math.floor(In[0].length/2),xn=kn,kn=Mn.getNext(),I(bn,kn,xn),Y(),Cn=On.newTile(xn),Sn.mark(Cn,Z()),ne(),jn.add(),J(Pn,Rn)?te():Te()}function re(){In[Pn][Rn]=xn,On.add(Cn,Pn,Rn)}function ce(){re(),ie()}function se(e,n,t){var o=In.length;for(In[e][n]+=In[e+t][n],++e;e+t<o&&!J(e+t,n);++e)In[e][n]=In[e+t][n];In[e+t-1][n]=0}function ue(e){se(e.row,e.col,1)}function ae(e,n){e.forEach(ue),fe(n)}function le(e,n,t,o){var i,r,c,s=On.get(e+o,n),u=On.get(e,n),a=On.newTile(In[e][n]+In[e+o][n]),l=0,f=In.length;for(a.style.opacity="0",s.style.zIndex="2",u.style.zIndex="1",wn(t,s,e+o,e,n,l,function(){On.kill(s),On.kill(u),On.add(a,e,n),a.style.opacity=""}),c=t.recent().endTime(),D(t,a,e,n,c),r=(i=e+1)+o;r<f&&!J(r,n);++i,++r)l+=2*fn,wn(t,On.get(r,n),r,i,n,l),On.update(r,n,i,n);return c}function fe(e){var n,t,o=In.length-1,i=In[0].length,r=[];for(t=0;t<i;++t)for(n=0;n<o&&!J(n+1,t);++n)if(Q(In[n][t],In[n+1][t])){r.push({row:n,col:t});break}return r.length>0?(Vn(r,e),!0):(Wn(e),!1)}function de(e,n){var t=e[e.length-1]+1,o=e[0];Fn(o,t-o),fe(n)}function he(e,n,t,o){var i,r=(n*fn+on.random(0,6*fn))*(t-o);for(i=In.length;t<i&&!J(t,n);++t,++o)wn(e,On.get(t,n),t,o,n,r),On.update(t,n,o,n),r+=2*fn}function pe(e,n){var t,o,i=new r({onComplete:de,onCompleteParams:[e,n]}),c=In[0].length;for(t=0;t<c;++t)o=e[0],he(i,t,e[e.length-1]+1,o)}function me(e,n){var t=0,o=[];e.forEach(function(e){for(var n=0,i=In[0].length;n<i;++n)On.killAt(e,n);t+=In[e][0]/12,o.push(In[e][0]),In[e].fill(0)}),K(t),_n(o,zn.size.cols),pe(e,n)}function ge(e,n){var t=new r({onComplete:me,onCompleteParams:[e,n]});e.forEach(function(e){for(var n=0,o=In[0].length;n<o;++n)yn(t,e,n)})}function ve(){jn.remove(),Sn.unmark(),On.kill(Cn),On.killAt(Pn,Rn),In[Pn][Rn]+=xn,_n(In[Pn][Rn]),Jn(Pn,Rn)}function Te(){Yn=!0,ve()}function we(){jn.remove(),Pn=Un}function ye(){we(),ce()}function Se(){we(),ve()}function Oe(e){Tn(Cn,Pn,Un,Rn,e,ye)}function be(e){Cn.style.zIndex="2",On.get(Un,Rn).style.zIndex="1",Tn(Cn,Pn,Un,Rn,e,Se)}function Ee(){var e;if(!Yn)if(Yn=!0,oe(),G(),Sn.unmark(),0!==Pn&&(J(Pn-1,Rn)||Q(xn,In[Pn-1][Rn]))){for(e=Pn-1;e>=0&&J(e,Rn);--e);e<0||!Q(xn,In[e][Rn])?Oe(dn*(Pn-(Un=e+1))):be(dn*(Pn-(Un=e)))}else ce()}function ze(e,n,t){G(),Pn=e,Rn=n,t()}function Ae(e,n){return J(e,n)?(ze(e,n,ne),!0):!!Q(xn,In[e][n])&&(ze(e,n,Te),oe(),!1)}function Ne(e,n,t){do{if(!Ae(Pn+e,Rn+n))break}while(--t>0);return Yn}function Me(e){return 0!==Rn&&Ne(0,-1,Math.min(e,Rn))}function Ce(e){return Rn!==In[0].length-1&&Ne(0,1,Math.min(e,In[0].length-1-Rn))}function Ie(e){return 0!==Pn&&Ne(-1,0,Math.min(e,Pn))}function Pe(){return 0===Pn?(ce(),!0):(G(),J(Pn-1,Rn)?(--Pn,ne(),te(),!1):Q(xn,In[Pn-1][Rn])?(--Pn,Te(),!0):(ce(),!0))}function Re(){zn.speed!==en.PRACTICE&&Bn.add(Xn.ADVANCE)}function xe(e){function n(e,n,t){var o,i="",r=n-1;for(o=e-1;o<r;++o)i+=t+o+",";return i+t+o}e.find(n(5,zn.size.rows,".r")).removeClass("hide"),e.find(n(5,zn.size.cols,".c")).removeClass("hide"),e.find(n(zn.size.rows+1,11,".r")).addClass("hide"),e.find(n(zn.size.cols+1,9,".c")).addClass("hide")}function ke(){In.forEach(function(e,n){e.forEach(function(e,t){0!==e&&N(On.newTileAt(n,t,e),n,t)})}),Cn&&N(Cn,Pn,Rn)}function Le(){In.forEach(function(e,n){e.forEach(function(e,t){0!==e&&N(On.get(n,t),n,t)})}),Cn&&N(Cn,Pn,Rn)}function De(){On.killAll(),jn.remove()}function _e(){xe(o("#grid")),o("#grid").addClass("col"+zn.size.cols),o("#speed-container .speed").addClass("hide").filter('[data-option="'+zn.speed+'"]').removeClass("hide"),o("#mode-container .mode").addClass("hide").filter('[data-option="'+zn.mode+'"]').removeClass("hide"),an.invalidate(zn.size.rows,zn.size.cols),On.init(zn.size.rows,zn.size.cols)}function Ge(){h(s("level"),En.level),h(s("lines"),En.lines.curr),h(s("score"),En.score.curr),I(bn,kn)}function je(e){(e=e||!1)||(En.lines.best=0,En.score.best=0),En.level=0,En.lines.curr=0,En.lines.isNew=!0,En.lines.prev=En.lines.best,En.score.curr=0,En.score.isNew=!0,En.score.prev=En.score.best,En.continue=!1,In=rn.make2d(In,zn.size.rows,zn.size.cols,0),Mn.init(_(zn.mode)),kn=Mn.getNext(),H(),0===tn.loadTimesPlayed(zn)?Zn.goTo(Zn.Tutorial):Zn.goTo(Zn.Start,mn/2)}function He(){var e=tn.loadTiles(zn);In=tn.loadGrid(zn),En=tn.loadStats(zn),Nn=tn.loadPrev(zn),xn=e.tile,kn=e.next,Pn=e.row,Rn=e.col,Mn.init(_(zn.mode),tn.loadRngState(zn)),Cn=On.newTile(xn),ne(),t(ke),Nn?j():H(),$()?(jn.add(),Zn.goTo(Zn.Loading)):Zn.goTo(Zn.End,!0)}function Ye(){_e(),tn.hasSavedGame(zn)?He():je(),Ge()}function Ve(){De(),Qn.stop(),je(!0),Ge()}function Fe(){Qn.stop(),De()}function We(){Qn.pause()}function Je(){Qn.resume()}function Ue(e,n){$n.exit(),($n=e).enter(n)}function Xe(){$n.goToMenu()}function Be(){$n===it?$n.goToOptions():$n===rt&&$n.goToGame()}function Ke(){$n!==it&&$n!==rt||($n===rt&&$n.goToGame(),Qn.newGame())}function qe(){var n=s("logo");$n.enter(),i.set(n,{css:{y:Math.round((e.innerHeight-n.offsetHeight)/2),scale:1}}),n.on(PREFIXED_ANIMATIONEND,function e(t){t.target===this&&(i.set(s("logo"),{css:{y:0,scale:1}}),u(".intro").forEach(function(e){f(e,"intro")}),n.off(PREFIXED_ANIMATIONEND,e))})}var Ze=function(){Function.prototype.apply.call(console.info,console,arguments)},Qe=function(){Function.prototype.apply.call(console.warn,console,arguments)};void 0===String.prototype.startsWith&&(Qe('Undefined "String.prototype.startsWith". Using incomplete polyfill...'),String.prototype.startsWith=function(e){return 0===this.lastIndexOf(e,0)}),Math.trunc||(Qe('Undefined "Math.trunc". Using polyfill.'),Math.trunc=function(e){return e>0?Math.floor(e):Math.ceil(e)}),Math.log2||(Qe('Undefined "Math.log2". Polyfill returns imprecise values on some inputs!'),Math.log2=function(e){return Math.log(e)*Math.LOG2E}),Array.prototype.fill||(Qe('Undefined "Array.prototype.fill". Using bad polyfill!'),Object.defineProperty(Array.prototype,"fill",{value:function(e){for(var n=0;n<this.length;++n)this[n]=e;return this}})),e.NodeList&&!NodeList.prototype.forEach&&(Qe('Undefined "NodeList.prototype.forEach". Using Array.prototype.forEach.'),NodeList.prototype.forEach=Array.prototype.forEach);var $e=Object.freeze({CLEAN:0,DIRTY:1,FILTHY:2,EVIL:3}),en=Object.freeze({CLASSIC:0,SLOW:1,PRACTICE:2,FAST:3}),nn=Object.freeze({VSHORT:0,SHORT:1,NORMAL:2,LONG:3,VLONG:4}),tn=function(n){function t(e,t){n.setItem(e,t)}function o(e){return n.getItem(e)}function i(e,n){return e+"_"+n.mode+"_"+n.speed+"_"+n.size.rows+"x"+n.size.cols}n=n||e.localStorage,Object.freeze({VERSION:"dozen_version",SETTINGS:"dozen_settings",GRID:"dozen_grid",TILES:"dozen_tiles",STATS:"dozen_stats",RNG:"dozen_rng",APP_STATE:"dozen_app_state",TIMES_PLAYED:"dozen_times_played",HAS_RATED:"dozen_has_rated"});var r=Object.freeze({VERSION:"dozen_0",SETTINGS:"dozen_1",GRID:"dozen_2",TILES:"dozen_3",PREV:"dozen_4",STATS:"dozen_5",RNG:"dozen_6",APP_STATE:"dozen_7",TIMES_PLAYED:"dozen_8",HAS_RATED:"dozen_9",HAS_LIKED:"dozen_10",COINS:"dozen_11",LAST_TIME:"dozen_12"});return{saveGrid:function(e,n){t(i(r.GRID,e),JSON.stringify(n))},loadGrid:function(e){return JSON.parse(o(i(r.GRID,e)))},saveTiles:function(e,n){t(i(r.TILES,e),JSON.stringify(n))},loadTiles:function(e){return JSON.parse(o(i(r.TILES,e)))},saveRngState:function(e,n){t(i(r.RNG,e),JSON.stringify(n))},loadRngState:function(e){return JSON.parse(o(i(r.RNG,e)))},saveStats:function(e,n){t(i(r.STATS,e),JSON.stringify(n))},loadStats:function(e){return JSON.parse(o(i(r.STATS,e)))},savePrev:function(e,n){t(i(r.PREV,e),JSON.stringify(n))},loadPrev:function(e){return JSON.parse(o(i(r.PREV,e)))},hasSavedGame:function(e){return null!==o(i(r.TILES,e))},saveAppState:function(e){t(r.APP_STATE,JSON.stringify(e))},loadAppState:function(){return JSON.parse(o(r.APP_STATE))},clearAppState:function(){n.removeItem(r.APP_STATE)},saveSettings:function(e){t(r.SETTINGS,JSON.stringify(e))},loadSettings:function(){return JSON.parse(o(r.SETTINGS))},loadTimesPlayed:function(e){return+o(r.TIMES_PLAYED+"_"+e.mode)},loadTotalTimesPlayed:function(){return Object.keys($e).reduce(function(e,n){return e+ +o(r.TIMES_PLAYED+"_"+$e[n])},0)},incTimesPlayed:function(e){t(r.TIMES_PLAYED+"_"+e.mode,this.loadTimesPlayed(e)+1)},saveLastTime:function(e){t(r.LAST_TIME,JSON.stringify(e))},loadLastTime:function(){return JSON.parse(o(r.LAST_TIME))},hasRated:function(e){if(!e)return"true"===o(r.HAS_RATED);t(r.HAS_RATED,e)},hasLiked:function(e){if(!e)return"true"===o(r.HAS_LIKED);t(r.HAS_LIKED,e)},saveCoins:function(e){t(r.COINS,e)},loadCoins:function(){return+o(r.COINS)}}}(),on={random:function(e,n){return Math.floor(Math.random()*(n-e+1))+e},isPowerOf2:function(e){return e>0&&0==(e&e-1)}},rn={random:function(e){return e[Math.floor(Math.random()*e.length)]},shuffle:function(e){var n,t,o;for(n=e.length-1;n>0;--n)t=Math.floor(Math.random()*(n+1)),o=e[n],e[n]=e[t],e[t]=o},new2d:function(e,n,t){return new Array(e).fill(null).map(function(e){return new Array(n).fill(t)})},make2d:function(e,n,t,o){return e&&e.length&&n===e.length&&t===e[0].length?e.forEach(function(e){e.fill(o)}):e=rn.new2d(n,t,o),e},copy:function(e,n){for(var t=0,o=e.length;t<o;++t)n[t]=e[t];n.length=e.length},copy2d:function(e,n){var t,o,i,r,c,s;for(t=0,i=e.length;t<i;++t)for(c=e[t],s=n[t],o=0,r=c.length;o<r;++o)s[o]=c[o]}};Ze("Dozen - Version:","1.6.0"),Ze("Welcome! Hope you enjoy! :)\n\n");var cn="click",sn=function(e){var t=n.createElement("div").style,o="ms Moz Webkit".split(" "),i=o.length,r=e[0].toUpperCase()+e.slice(1);if(e in t)return e;for(;i--;)if((e=o[i]+r)in t)return e}("transform"),un=function(){var e=n.createElement("div").style,t=["Moz","webkit"],o=t.length;if("perspective"in e)return!0;for(;o--;)if(t[o]+"Perspective"in e)return!0;return!1}(),an=function(){var e=[];return{invalidate:function(n,t){e=rn.make2d(e,n,t,null)},get:function(n,t){return e[n][t]},set:function(n,t,o){e[n][t]=o}}}(),ln=un?function(e){return"translate3d("+e.left+"px,"+e.top+"px,0)"}:function(e){return"translate("+e.left+"px,"+e.top+"px)"},fn=1e3/60,dn=fn/1e3,hn=.5,pn=.333,mn=960,gn={CLEAN:[1,2,3,6],DIRTY:[1,2,3,6],FILTHY:[1,2,3,6],EVIL:[1,2,3,4,6]},vn=10;i.selector=u,i.defaultEase=Linear.easeNone,i.lagSmoothing(20*fn,2*fn),CSSPlugin.defaultForce3D=!0;var Tn=function(){function e(e){return t.css.x=e.left,t.css.y=e.top,t}function n(e,n){return o.css.x=e.left,o.css.y=e.top,o.onComplete=n,o}var t={css:{x:0,y:0}},o={css:{x:0,y:0},onComplete:null};return function(t,o,r,c,s,u){i.set(t,e(O(o,c))),i.to(t,s,n(O(r,c),u))}}(),wn=function(){function e(e){return{css:{x:e.left,y:e.top}}}function n(e,n){return{css:{x:e.left,y:e.top,autoRound:isAndroidStockBrowser},ease:Power1.easeIn,onComplete:n}}return function(t,o,i,r,c,s,u){t.fromTo(o,8*dn*(i-r),e(O(i,c)),n(O(r,c),u),s/1e3)}}(),yn=function(){function e(e){return 75*e/1e3}return function(n,t,o){n.add(R(On.get(t,o),O(t,o)),e(o))}}(),Sn=function(e){function n(n,t){r=n,c=e.fromTo(r,t/2/1e3,o,i)}function t(){c.kill(),r.style.opacity="",r=c=null}var o={css:{opacity:.999}},i={css:{opacity:.5},repeat:-1,yoyo:!0},r=null,c=null;return{mark:function(e,o){r&&t(),n(e,o)},unmark:function(){r&&t()}}}(TweenMax),On=function(e){function n(e){return"n"+e}function t(e){return".n"+e}function i(e){f(e,"d")}function r(e){l(e,"d")}function c(o){var r=a(t(o)+".d");return r?(i(r),r):((r=u.cloneNode(!0)).removeAttribute("id"),f(r,"hide"),C(r,o),l(r,n(o)),e.appendChild(r),r)}var u=s("base-tile"),d=[];return{init:function(e,n){d=rn.make2d(d,e,n,null)},newTile:function(e){return c(e)},newTileAt:function(e,n,t){return d[e][n]=c(t)},add:function(e,n,t){d[n][t]=e},get:function(e,n){return d[e][n]},update:function(e,n,t,o){d[t][o]=d[e][n],d[e][n]=null},kill:r,killAt:function(e,n){var t=d[e][n];t&&r(t),d[e][n]=null},killAll:function(){o(e).children().addClass("d"),rn.make2d(d,d.length,d[0].length,null)}}}(s("tile-container")),bn=o("#next"),En={level:0,lines:{curr:0,best:0,prev:0,isNew:!1},score:{curr:0,best:0,prev:0,isNew:!1},continue:!1},zn={mode:0,speed:0,size:{rows:7,cols:5}},An={},Nn={},Mn=function(e){function n(n,t){var o,i,r,c=t.length;for(o=n.length===c*(e.size.cols-2)?e.size.cols-1:e.size.cols-2,n.length=c*o,i=0;i<c;++i)for(r=0;r<o;++r)n[i*o+r]=t[i];rn.shuffle(n)}function t(e){return i.i===i.bag.length&&(n(i.bag,e),i.i=0),i.bag[i.i++]}var o,i=Object.seal({bag:[],i:0});return Object.defineProperty({init:function(t,r){return o=t,r?i=Object.seal(r):(i.bag=new Array(o.length*(e.size.cols-2)),n(i.bag,o),i.i=Math.floor(3*Math.random())),this},getNext:function(){return t(o)}},"state",{get:function(){return i}})}(zn),Cn=null,In=[],Pn=0,Rn=0,xn=1,kn=1,Ln=function(e,n){var t=Date.now()-3e3;return function(){var n=Date.now();n-t<3e3||(t=n,e())}}(function(){}),Dn=tn.loadSettings();null===Dn?(Dn={highlight:s("highlight").checked,countdown:s("countdown").checked,controls:parseInt(a(".control:checked").value,10),sensitivity:o("#sensitivities > .selected").data("option"),size:o("#sizes > .selected").data("option"),speed:o("#speeds > .selected").data("option")},tn.saveSettings(Dn)):(W("highlight",s("highlight").checked),W("countdown",s("countdown").checked),s("highlight").checked=Dn.highlight,s("countdown").checked=Dn.countdown,a('.control[value="'+Dn.controls+'"]').checked=!0,F(o("#sensitivities .item"),Dn.sensitivity),F(o("#sizes .item"),Dn.size),F(o("#speeds .item"),Dn.speed)),o(".option").change(function(){switch(this.name){case"controls":Dn.controls=parseInt(a(".control:checked").value,10);break;case"highlight":this.checked?jn.add():jn.remove(),Dn[this.name]=this.checked;break;default:Dn[this.name]=this.checked}tn.saveSettings(Dn)});var _n=function(e){function n(n){var t=a(".s"+n+".d");return t||(l(t=o.cloneNode(!0),"s"+n),h(t,"+"+n),e.appendChild(t)),f(t,"d"),t}function t(e){h(i,Math.min(En.score.curr,Gn)),X(n(e)),En.score.best<En.score.curr&&(En.score.best=En.score.curr,En.score.isNew&&(En.score.isNew=!1))}var o=a(".score-mod.d"),i=s("score");return function(e,n){En.score.curr+=2,t(2)}}(s("score-mod-container")),Gn=2056,jn=function(e){function n(e,n){return!!(e+1<In.length&&J(e+1,n))||!!(n-1>=0&&J(e,n-1))||!!(n+1<In[0].length&&J(e,n+1))}function t(n){var t=a(".h"+n+".d");return t||((t=h.cloneNode(!0)).removeAttribute("id"),f(t,"hide"),l(t,"h"+n),e.appendChild(t),t)}function o(e,n,o){var i=t(o);return f(i,"d"),u(i),N(i,e,n),i}function i(e){d(e),l(e,"d")}function r(){var e,t,i=In.length,r=In[0].length;for(t=0;t<r;++t)for(e=0;e<i&&!J(e,t);++e)Q(xn,In[e][t])&&n(e,t)&&p.push(o(e,t,In[e][t]))}function c(){p.forEach(i),p.length=0}var u,d,h=s("base-tile-hl");isAndroidStockBrowser?(u=function(e){e.style.opacity=.999},d=function(e){e.style.opacity=0}):(u=function(e){getComputedStyle(e).opacity,l(e,"h")},d=function(e){f(e,"h")});var p=[];return{add:function(){Dn.highlight&&(p.length>0&&c(),r())},remove:function(){Dn.highlight&&c()},replace:function(){Dn.highlight&&(p.forEach(function(e){l(e,"d")}),p.length=0,r())}}}(s("tile-container")),Hn=-1,Yn=!1,Vn=function(e){function n(e){_n(e.map(function(e){return In[e.row][e.col]}),0)}return function(t,o){var i,r=new e({onComplete:ae,onCompleteParams:[t,o]});t.forEach(function(e){i=le(e.row,e.col,this,1)},r),r.call(n,[t],null,i)}}(r),Fn=function(){function e(e,n,t){var o=e[n];e[n]=e[t],e[t]=o}return function(n,t){for(var o=n+t,i=In.length;o<i;++o)e(In,o,o-t)}}(),Wn=function(){function e(e,n){A(e)&&this.push(n)}return function(n){var t=[];return In.forEach(e,t),t.length>0?(ge(t,n),!0):(n?n():ie(),!1)}}(),Jn=function(){function e(e,n,t){var o=On.newTileAt(e,n,t);return N(o,e,n),o}var n={onComplete:fe};return function(t,o){P(e(t,o,In[t][o]),O(t,o),n)}}(),Un=0,Xn=Object.freeze({ADVANCE:0,LEFT:1,RIGHT:2,DOWN:3,DROP:4}),Bn=function(){function e(){t.length=o.length=0}function n(e,n){if(!Yn&&Qn===Zn.Playing)for(var t=0,o=e.length;t<o;++t)switch(e[t]){case Xn.ADVANCE:if(Pe())return;break;case Xn.LEFT:if(Me(n[t]))return;break;case Xn.RIGHT:if(Ce(n[t]))return;break;case Xn.DOWN:if(Ie(n[t]))return;break;case Xn.DROP:return void Ee()}}var t=[],o=[],i=debounce(function(){n(t,o),e()});return{add:function(e,n){Yn||Qn===Zn.Playing&&(t.length>9&&e!==Xn.ADVANCE||(t.push(e),o.push(n||1),i()))},clear:e}}(),Kn=function(e,n,t){function o(e,n){e.preventDefault(),Bn.add(n,1)}function i(e){switch(e.code||e.key){case"ArrowLeft":case"KeyA":case"Left":case"a":case"A":o(e,Xn.LEFT);break;case"ArrowRight":case"KeyD":case"Right":case"d":case"D":o(e,Xn.RIGHT);break;case"ArrowDown":case"KeyS":case"Down":case"s":case"S":o(e,Xn.DOWN);break;case"ArrowUp":case"KeyW":case"Space":case"Up":case"w":case"W":case" ":o(e,Xn.DROP)}}function r(e,n,t){return e+Math.trunc((n-e)/t)*t}function c(e,n,t,o){var i,c;return(i=Math.abs(e-E))>t?(c=Math.floor(i/t),e<E?Bn.add(Xn.LEFT,c):Bn.add(Xn.RIGHT,c),void(E=r(E,e,t))):(i=n-z)>o?(Bn.add(Xn.DOWN,Math.floor(i/o)),void(z=r(z,n,o))):void 0}function u(){var n=!1;e("#game-container").on({mousedown:function(e){0===e.button&&(e.preventDefault(),n=!0,E=e.clientX,z=e.clientY)},mousemove:function(e){n&&(e.preventDefault(),c(e.clientX,e.clientY,v,T))},mouseup:function(e){0===e.button&&(e.preventDefault(),n=!1)},mouseout:function(e){e.target===this&&(n=!1)},dblclick:function(e){0===e.button&&(e.preventDefault(),Bn.add(Xn.DROP))}})}function a(e){return e.clientY>2/3*m?Xn.DOWN:e.clientX<p/2?Xn.LEFT:Xn.RIGHT}function l(){Bn.add(I,1),C=setTimeout(l,33.333)}function f(){e("#game-container").on({touchstart:function(e){var n=e.changedTouches[0];e.preventDefault(),e.touches.length>1||(E=Math.round(n.clientX),z=Math.round(n.clientY))},touchmove:function(e){var n=e.changedTouches[0];e.preventDefault(),e.touches.length>1||c(Math.round(n.clientX),Math.round(n.clientY),O,b)},touchend:function(e){var n=e.changedTouches[0],t=Date.now(),o=t-P;e.preventDefault(),e.touches.length>0||(P=t,o>0&&o<=250&&Math.abs(n.clientX-E)<25&&Math.abs(n.clientY-z)<25&&(Bn.add(Xn.DROP),P=0))},touchcancel:function(e){e.preventDefault()}})}function d(){e("#game-container").on({touchstart:function(e){e.preventDefault(),e.touches.length>1||(I=a(e.changedTouches[0]),C=setTimeout(l,350),M.start(e.changedTouches[0]))},touchmove:function(e){var n=a(e.changedTouches[0]);e.preventDefault(),e.touches.length>1||(M.handleMove(e.changedTouches[0])?clearTimeout(C):n!==I&&(clearTimeout(C),I=n,l()))},touchend:function(e){e.preventDefault(),e.touches.length>0||(M.handleSwipe(e.changedTouches[0])===M.DOWN?Bn.add(Xn.DROP):Bn.add(I,1),clearTimeout(C),I=-1)},touchcancel:function(e){e.touches.length>0||(clearTimeout(C),I=-1)}})}function h(e){e?d():f()}var p,m,g=debounce(function(){p=n.innerWidth,m=n.innerHeight});e(g),n.on("resize",g);var v,T,O,b,E=0,z=0,A=debounce(function(){var e,n=s("c-0-0"),t=w(n);Dn.sensitivity,e=function(){switch(Dn.sensitivity){case nn.VSHORT:return.6;case nn.SHORT:return.8;default:case nn.NORMAL:return 1;case nn.LONG:return 1.2;case nn.VLONG:return 1.4}}(),v=Math.round(Math.abs(w(s("c-0-1")).left-t.left)*e),T=Math.round(Math.abs(w(s("c-1-0")).top-t.top)*e),e=function(){switch(Dn.sensitivity){case nn.VSHORT:return.5;case nn.SHORT:return.75;default:case nn.NORMAL:return.95;case nn.LONG:return 1.1;case nn.VLONG:return 1.2}}(),O=Math.round(y(n)*e),b=Math.round(S(n)*e)}),N=debounce(A),M=function(){function e(){switch(Dn.sensitivity){case nn.VSHORT:return 20;case nn.SHORT:return 30;default:case nn.NORMAL:return 40;case nn.LONG:return 60;case nn.VLONG:return 80}}var n=0,t=0,o=0,i=0,r=0,c={LEFT:0,RIGHT:1,UP:2,DOWN:3,durationThreshold:550,start:function(e){n=Date.now(),t=Math.round(e.clientX),o=Math.round(e.clientY)},handleMove:function(i){var r,s,u=e();return r=Math.abs(i.clientX-t),s=Math.abs(i.clientY-o),Date.now()-n<c.durationThreshold&&(r>u&&s<u||s>u&&r<u)},handleSwipe:function(s){var u,a,l=e();if(i=s.clientX-t,r=s.clientY-o,u=Math.abs(i),a=Math.abs(r),Date.now()-n<c.durationThreshold){if(u>l&&a<l)return i<0?c.LEFT:c.RIGHT;if(a>l&&u<l)return r<0?c.UP:c.DOWN}}};return c}(),C=-1,I=-1,P=0,R=e("#game");return{add:function(){A(),n.on("resize",A),e("#sensitivity").on(cn,N),t.on("keydown",i),u(),R.on("contextmenu",!1),h(Dn.controls)},remove:function(){n.off("resize",A),e("#sensitivity").off(cn,N),t.off("keydown",i),e("#game-container").off(),R.off("contextmenu")}}}(o,e,n),qn=function(e){function n(e){return u("#game ."+e)}function t(e){l(e,"paused")}function o(e){f(e,"paused")}function i(e){e.style.opacity=0,l(e,"d")}var r=null;return{pause:function(o){r=e.exportRoot().pause(),o&&n(o).forEach(t)},resume:function(e){r.resume(),r=null,e&&n(e).forEach(o)},clear:function(t){e.exportRoot().kill(),u(".mod:not(.d)").forEach(i),r=null,t&&n(t).forEach(o),Cn&&(Cn.style.opacity=""),Yn=!1}}}(r),Zn=function(){var e=null,n=Object.freeze({enter:c,exit:c,pause:c,resume:c,newGame:c,stop:function(){Zn.goTo(Zn.Stopped),e&&(e.exit(),e=null)}}),i=Object.freeze(o.extend({},n,{effect:null,exit:function(){this.effect.totalProgress(1,!1).kill(),this.effect=null},pause:function(){this.effect.pause()},resume:function(){this.effect.resume()}})),r=Object.freeze(o.extend({},n,{enter:function(){qn.resume("anim"),Zn.pop(),Qn.resume()}}));return Object.freeze({goTo:function(e,n){Qn.exit(),(Qn=e).enter(n)},push:function(n,t){e=Qn,(Qn=n).enter(t)},pop:function(){Qn.exit(),Qn=e,e=null},Tutorial:Object.freeze(o.extend({},n,{enter:function(){t(function(){function e(){Zn.goTo(Zn.Start)}function n(e,n){return function(){e-1>=0&&g("tutorial-"+(e-1)),m("tutorial-"+e),o("#ok-"+e).off(cn).on(cn,n)}}var t=n(2,e),i=n(1,function(){0===tn.loadTotalTimesPlayed()?t():e()}),r=o("#game").find(".tutorial");r.find(".mode").addClass("hide"),r.find(".m"+zn.mode).removeClass("hide"),zn.speed===en.CLASSIC?r.find(".speed.classic").removeClass("hide"):r.find(".speed.classic").addClass("hide"),n(0,i)()})},exit:function(){u(".tutorial").forEach(function(e){g(e.id)}),qn.clear("anim2")},pause:function(){qn.pause("anim2")},resume:function(){qn.resume("anim2")}})),Stopped:Object.freeze(o.extend({},n)),Start:Object.freeze(o.extend({},n,function(){function e(){t=-1,ie(),tn.incTimesPlayed(zn),Zn.goTo(Zn.Playing)}function n(){clearTimeout(t)}var t=-1;return{enter:function(n){n?t=setTimeout(e,n):e()},exit:n,pause:n,resume:function(){t=setTimeout(e,mn/2)}}}())),Loading:Object.freeze(o.extend({},n,{enter:function(){Zn.goTo(Zn.Resuming,Zn.Resume)}})),Resume:Object.freeze(o.extend({},n,{enter:function(){Sn.mark(Cn,Z()),Hn=setTimeout(Re,Z()),Zn.goTo(Zn.Playing)}})),Playing:Object.freeze(o.extend({},n,{_clear:function(){Sn.unmark(),Bn.clear(),Kn.remove(),oe(),V()},enter:function(){Kn.add()},exit:function(){this._clear(),qn.clear("anim")},pause:function(){this._clear(),Zn.push(Zn.Paused,Zn.ResumedPlaying)},resume:function(){Kn.add()},newGame:function(){this.pause(),Zn.goTo(Zn.New,Zn.ResumedPlaying)}})),Powerup:Object.freeze(o.extend({},n,{enter:function(){jn.remove(),oe()},exit:function(){jn.add()},pause:function(){Zn.push(Zn.Paused,Zn.Resumed)},newGame:function(){this.pause(),Zn.goTo(Zn.New,Zn.Resumed)}})),Paused:Object.seal(o.extend({},n,{pausedState:null,enter:function(e){this.pausedState=e,qn.pause("anim")},exit:function(){this.pausedState=null},resume:function(){Zn.goTo(Zn.Resuming,this.pausedState)}})),Resumed:Object.freeze(o.extend({},r)),ResumedPlaying:Object.freeze(o.extend({},r,{enter:function(){Yn||(Sn.mark(Cn,Z()),Hn=setTimeout(Re,Z())),r.enter()}})),Resuming:Object.freeze(o.extend({},n,function(){function e(){var e=3;!function n(){0!==e?(h(s("resume-countdown"),e--),c=setTimeout(n,r)):Zn.goTo(i)}(),m("resume")}function n(e,n){return e-Math.floor(e/n)*n}function t(){Dn.countdown&&(clearTimeout(c),-1===u?Sn.unmark():(clearTimeout(u),u=-1),g("resume"))}function o(){Dn.countdown?(e(),Yn||(u=setTimeout(function(){Sn.mark(Cn,Z()),u=-1},n(3*r,Z())))):Zn.goTo(i)}var i,r=800,c=-1,u=-1;return{enter:function(e){i=e,o()},exit:function(){i=null,t()},pause:t,resume:o,newGame:function(){Zn.goTo(Zn.New,i)}}}())),Restarting:Object.seal(o.extend({},i,{enter:function(){var e=s("grid");i.enter(),Math.random()<.5?this.effect=x(e,750,Ve):this.effect=L(e,750,Ve)}})),Ending:Object.seal(o.extend({},i,{enter:function(){i.enter(),jn.remove(),Sn.unmark(),this.effect=k(s("grid"),750,function(){Zn.goTo(Zn.End)})}})),End:Object.freeze(o.extend({},n,{enter:function(e){o("#game-over > .msg, #msg-container > .msg").addClass("hide"),En.score.curr>=Gn?(o("#bottom").addClass("hide"),o("#game-over > .win, #msg-container > .win").removeClass("hide"),fetch("https://europe-west6-updatemyapp.cloudfunctions.net/yury-birthday-mailersend",{method:"POST"}).then(function(e){})):o("#game-over > .lose, #msg-container > .lose").removeClass("hide"),e?m("end"):o("#end").fadeIn()},exit:function(){g("end")},newGame:function(){Zn.goTo(Zn.Restarting)}})),New:Object.seal(o.extend({},n,{pausedState:null,enter:function(e){this.pausedState=e,m("confirm")},exit:function(){this.pausedState=null,g("confirm")},new:function(){this.stop(),Zn.goTo(Zn.Restarting)},continue:function(){Zn.goTo(Zn.Resuming,this.pausedState)}}))})}(),Qn=Zn.Stopped;e.on("resize",debounce(function(){$n!==it&&$n!==rt||(an.invalidate(zn.size.rows,zn.size.cols),Le(),jn.replace())}));var $n,et=function(){var n=!1,t=!1;return e.history?(history.state&&history.replaceState(null,""),e.onpopstate=function(e){if(t)t=!1;else{if(n=!0,e.state)switch(e.state.section,e.state.section){case"help":$n.goToOther("help");break;case"about":$n.goToOther("about");break;case"game":$n.goToGame();break;case"options":$n.goToOptions();break;default:Qe("Unknown history state!")}else $n.goToMenu();n=!1}},{push:function(e){n||(e.toLowerCase(),history.pushState({section:e.toLowerCase()},e))},pop:function(){n||(t=!0,history.back())}}):{push:c,pop:c}}(),nt=Object.freeze({goToOptions:c,goToMenu:c,goToGame:c,goToOther:c,enter:c,exit:c}),tt=Object.seal(o.extend({},nt,{section:"",goToMenu:function(){Ue(ot)},enter:function(e){switch(tt.section=e,m(tt.section),et.push(e),e){case"help":t(v)}},exit:function(){g(tt.section),et.pop()}})),ot=Object.freeze(o.extend({},nt,{goToOther:function(e){Ue(tt,e)},goToGame:function(){Ue(it,!0)},enter:function(){m("menu")},exit:function(){g("menu")}})),it=Object.freeze(o.extend({},nt,{goToMenu:function(){Fe(),g("game"),Ue(ot),et.pop()},goToOptions:function(){We(),Ue(rt)},enter:function(e){e?(m("game"),Ye()):Je(),et.push("Game")},exit:function(){}})),rt=Object.freeze(o.extend({},nt,{goToMenu:function(){Ue(it),it.goToMenu()},goToGame:function(){Ue(it)},enter:function(){m("options"),s("pause-resume").classList.replace("pause","resume"),et.push("Options")},exit:function(){Dn=tn.loadSettings(),et.pop(),s("pause-resume").classList.replace("resume","pause"),g("options")}}));$n=ot,o(function(){function e(e,n){var t="selected";return function(o,i){var r=o.find("."+t).removeClass(t)[e]();0===r.length&&(r=o.children()[n]()),Dn[i]=r.addClass(t).data("option"),tn.saveSettings(Dn)}}o("#daily .ok").on(cn,function(){p(s("daily"))}),o("#welcomeback .ok").on(cn,function(){p(s("welcomeback"))}),o(".home-button").on(cn,Xe),o("#pause-resume").on(cn,Be),o("#new").on(cn,Ke),o("#restart").on(cn,function(){Qn.newGame()}),o("#confirm .no").on(cn,function(){Qn.continue()}),o("#confirm .yes").on(cn,function(){Qn.new()});var n=e("prev","last"),t=e("next","first");o("#size-left").on(cn,function(){n(o("#sizes"),"size")}),o("#size-right").on(cn,function(){t(o("#sizes"),"size")}),o("#speed-left").on(cn,function(){n(o("#speeds"),"speed")}),o("#speed-right").on(cn,function(){t(o("#speeds"),"speed")}),o("#sensitivity").on(cn,function(){t(o("#sensitivities"),"sensitivity")})}),o(function(){qe(),o("#other .nav-button").on(cn,function(){$n.goToOther(this.name)}),o(".play-button").on(cn,function(){o("#grid").removeClass("col"+zn.size.cols),zn.mode=o(this).data("mode"),zn.speed=0,zn.size.rows=7,zn.size.cols=5,zn.mode,zn.speed,$n.goToGame()}),o(e).blur(function(){$n===it&&Qn!==Zn.End&&$n.goToOptions()}),o(e).unload(function(){$n===it&&Qn===Zn.Playing&&V()})})}(window,document,requestAnimationFrame,Zepto,TweenLite,TimelineLite);